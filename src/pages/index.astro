---
import MuseumLayout from '../layouts/MuseumLayout.astro';
import ExhibitCard from '../components/ExhibitCard.astro';
import { getCollection } from 'astro:content';

// Fetch data from Content Collection
const posts = await getCollection('exhibits');

// Sort posts by date (Oldest first for history)
posts.sort((a, b) => a.data.date.getTime() - b.data.date.getTime());
---

<MuseumLayout title="The Grand Gallery">
	<section class="max-w-2xl mx-auto text-center mb-20 animate-fade-in">
		<h2 class="font-display text-4xl md:text-5xl text-museum-gold mb-6 drop-shadow-lg">
			The Grand Gallery
		</h2>
		<p class="font-body text-xl text-museum-paper/80 italic leading-relaxed">
			"Knowledge, like art, belongs to the world. Wander through these halls and discover the fragments of wisdom we have preserved."
		</p>
	</section>

	<div class="grid grid-cols-1 md:grid-cols-2 gap-12 md:gap-16">
        {posts.map((post) => (
            <ExhibitCard 
                title={post.data.title} 
                author={post.data.author} 
                date={post.data.date.toISOString()}
                tags={post.data.tags}
                url={`/posts/${post.slug}`}
                description={post.data.description}
                cover={post.data.cover}
                image={post.data.image}
            />
        ))}
        
        {posts.length === 0 && (
            <div class="col-span-full text-center py-20 border border-museum-gold/30 rounded bg-museum-bg/50">
                <p class="font-display text-museum-gold text-xl">The archives are currently empty.</p>
                <p class="font-body text-museum-paper/60 mt-2">Please decorate the ./data directory with markdown artifacts.</p>
            </div>
        )}
	</div>
</MuseumLayout>
